// Generated by CoffeeScript 1.9.1
(function() {
  var helpers;

  helpers = require('helpers');

  require.register("model/chart", function(exports, require, module) {
    var Chart;
    Chart = Chart = (function() {
      function Chart(model, parent, location) {
        this.model = model;
        this.parent = parent;
        this.location = location;
        this._guides = {};
        this._data = [];
      }

      Chart.prototype.setData = function(properties) {
        var i, len, prop, ref, results;
        this.properties = properties;
        this._data = [];
        ref = this.properties;
        results = [];
        for (i = 0, len = ref.length; i < len; i++) {
          prop = ref[i];
          results.push(this._data.push({
            category: prop.title,
            description: prop.description,
            count: 0,
            prop: prop.property
          }));
        }
        return results;
      };

      Chart.prototype.reset = function() {
        this.parent.innerHTML = "";
        this._drawChart();
        return this.update();
      };

      Chart.prototype.update = function() {
        var column, i, len, newData, ref;
        if (!this.model.isSetUp) {
          return;
        }
        newData = this.model.current_counts[this.location];
        ref = this._data;
        for (i = 0, len = ref.length; i < len; i++) {
          column = ref[i];
          column.count = newData[column.prop];
        }
        return this.chart.validateData();
      };

      Chart.prototype._drawChart = function() {
        var opts;
        opts = helpers.clone(this._defaultChartProps);
        opts.graphs.push({
          balloonText: "<b>[[value]]</b> [[description]]",
          fillAlphas: 0.8,
          lineAlpha: 0.2,
          type: "column",
          valueField: "count"
        });
        opts.dataProvider = this._data;
        return this.chart = AmCharts.makeChart(this.parent, opts);
      };

      Chart.prototype._defaultChartProps = {
        type: 'serial',
        theme: 'light',
        marginTop: 10,
        marginRight: 0,
        marginLeft: 0,
        marginBottom: 0,
        categoryAxis: {
          dashLength: 1,
          minorGridEnabled: true
        },
        valueAxes: [
          {
            title: 'Number of Rats',
            autoGridCount: false,
            gridCount: 6,
            showFirstLabel: false,
            strictMinMax: true,
            minimum: 0,
            maximum: Chart.location === 'all' ? 50 : 30,
            position: 'left'
          }
        ],
        categoryField: 'category',
        graphs: []
      };

      Chart.prototype.startPeriod = function(id) {};

      Chart.prototype.endPeriod = function(id) {};

      Chart.prototype._extendOpenPeriods = function(date) {};

      return Chart;

    })();
    return module.exports = Chart;
  });

}).call(this);
